Version 4
SHEET 1 2228 3988
WIRE -544 384 -560 384
WIRE -384 384 -400 384
WIRE -1280 416 -1280 400
WIRE -1168 416 -1168 400
WIRE -640 432 -688 432
WIRE -560 432 -560 384
WIRE -560 432 -640 432
WIRE -384 432 -384 384
WIRE -352 432 -384 432
WIRE -320 432 -352 432
WIRE -352 464 -352 432
WIRE -688 480 -688 432
WIRE -560 480 -560 432
WIRE -544 480 -560 480
WIRE -384 480 -384 432
WIRE -384 480 -400 480
WIRE -1280 512 -1280 496
WIRE -1168 512 -1168 496
WIRE 272 528 144 528
WIRE 464 528 336 528
WIRE -688 576 -688 512
WIRE -352 576 -352 544
WIRE -352 576 -688 576
WIRE -320 576 -352 576
WIRE 352 576 336 576
WIRE -1280 592 -1280 576
WIRE -1168 592 -1168 576
WIRE 352 592 352 576
WIRE 144 640 144 528
WIRE 160 640 144 640
WIRE 176 640 160 640
WIRE 288 640 272 640
WIRE 304 640 288 640
WIRE 320 640 304 640
WIRE 336 640 336 576
WIRE 336 640 320 640
WIRE 352 640 336 640
WIRE 432 640 416 640
WIRE 448 640 432 640
WIRE 464 640 464 528
WIRE 464 640 448 640
WIRE 144 672 144 640
WIRE 464 672 464 640
WIRE -976 768 -1008 768
WIRE -880 768 -896 768
WIRE -656 768 -688 768
WIRE -560 768 -576 768
WIRE -144 784 -192 784
WIRE 16 784 -144 784
WIRE 144 784 144 752
WIRE 144 784 16 784
WIRE 464 784 464 752
WIRE 672 784 464 784
WIRE 784 784 672 784
WIRE 832 784 784 784
WIRE 784 800 784 784
WIRE -1008 816 -1008 768
WIRE -992 816 -1008 816
WIRE -560 816 -560 768
WIRE -144 816 -144 784
WIRE -1008 832 -1008 816
WIRE -1008 832 -1040 832
WIRE 16 832 16 816
WIRE 64 832 16 832
WIRE 672 832 672 816
WIRE 704 832 672 832
WIRE -1168 848 -1216 848
WIRE -1008 864 -1040 864
WIRE 48 864 16 864
WIRE 736 864 672 864
WIRE -1008 880 -1008 864
WIRE -992 880 -1008 880
WIRE -144 912 -144 880
WIRE -144 912 -192 912
WIRE -128 912 -144 912
WIRE -112 912 -128 912
WIRE -16 912 -32 912
WIRE 16 912 16 864
WIRE 16 912 -16 912
WIRE 304 912 304 640
WIRE 304 912 16 912
WIRE 512 912 304 912
WIRE 528 912 512 912
WIRE 624 912 608 912
WIRE 672 912 672 864
WIRE 672 912 624 912
WIRE 784 912 784 864
WIRE 784 912 672 912
WIRE 816 912 784 912
WIRE 832 912 816 912
WIRE -1008 928 -1008 880
WIRE -880 928 -1008 928
WIRE -560 928 -560 896
WIRE -560 928 -688 928
WIRE 816 944 816 912
WIRE 176 1232 144 1232
WIRE 288 1232 176 1232
WIRE 848 1232 816 1232
WIRE 960 1232 848 1232
WIRE 144 1248 144 1232
WIRE 176 1248 176 1232
WIRE 816 1248 816 1232
WIRE 848 1248 848 1232
WIRE 64 1312 64 832
WIRE 144 1312 144 1280
WIRE 144 1312 96 1312
WIRE 176 1312 176 1280
WIRE 176 1312 144 1312
WIRE 192 1312 176 1312
WIRE 736 1312 736 864
WIRE 816 1312 816 1280
WIRE 816 1312 768 1312
WIRE 848 1312 848 1280
WIRE 848 1312 816 1312
WIRE 864 1312 848 1312
WIRE 288 1328 288 1232
WIRE 288 1328 256 1328
WIRE 304 1328 288 1328
WIRE 368 1328 336 1328
WIRE 416 1328 368 1328
WIRE 960 1328 960 1232
WIRE 960 1328 928 1328
WIRE 1040 1328 960 1328
WIRE 1104 1328 1072 1328
WIRE 1152 1328 1104 1328
WIRE 48 1344 48 864
WIRE 96 1344 48 1344
WIRE 144 1344 128 1344
WIRE 176 1344 144 1344
WIRE 192 1344 176 1344
WIRE 704 1344 704 832
WIRE 768 1344 704 1344
WIRE 816 1344 800 1344
WIRE 848 1344 816 1344
WIRE 864 1344 848 1344
WIRE 1104 1344 1104 1328
WIRE 1152 1344 1152 1328
WIRE 144 1360 144 1344
WIRE 368 1360 368 1328
WIRE 416 1360 416 1328
WIRE 816 1360 816 1344
WIRE -304 1376 -304 1328
WIRE 176 1376 176 1344
WIRE 848 1376 848 1344
WIRE 1104 1392 1104 1376
WIRE 1152 1392 1152 1376
WIRE 144 1408 144 1392
WIRE 368 1408 368 1392
WIRE 416 1408 416 1392
WIRE 816 1408 816 1392
WIRE 256 1440 144 1440
WIRE 832 1440 720 1440
WIRE 144 1456 144 1440
WIRE 720 1456 720 1440
WIRE -304 1504 -304 1456
WIRE -16 1520 -16 912
WIRE 32 1520 -16 1520
WIRE 144 1520 144 1488
WIRE 144 1520 64 1520
WIRE 160 1520 144 1520
WIRE 512 1520 512 912
WIRE 640 1520 512 1520
WIRE 720 1520 720 1488
WIRE 720 1520 672 1520
WIRE 736 1520 720 1520
WIRE 256 1536 256 1440
WIRE 256 1536 224 1536
WIRE 288 1536 256 1536
WIRE 352 1536 320 1536
WIRE 400 1536 352 1536
WIRE 832 1536 832 1440
WIRE 832 1536 800 1536
WIRE 864 1536 832 1536
WIRE 928 1536 896 1536
WIRE 976 1536 928 1536
WIRE -128 1552 -128 912
WIRE -16 1552 -128 1552
WIRE 144 1552 16 1552
WIRE 160 1552 144 1552
WIRE 352 1552 352 1536
WIRE 400 1552 400 1536
WIRE 624 1552 624 912
WIRE 672 1552 624 1552
WIRE 720 1552 704 1552
WIRE 736 1552 720 1552
WIRE 928 1552 928 1536
WIRE 976 1552 976 1536
WIRE 144 1568 144 1552
WIRE 720 1584 720 1552
WIRE 352 1600 352 1584
WIRE 400 1600 400 1584
WIRE 928 1600 928 1584
WIRE 976 1600 976 1584
WIRE 144 1616 144 1600
WIRE -1488 2640 -1584 2640
WIRE -1328 2640 -1408 2640
WIRE -1120 2640 -1216 2640
WIRE -960 2640 -1040 2640
WIRE -1584 2688 -1584 2640
WIRE -1216 2688 -1216 2640
WIRE -1328 2704 -1328 2640
WIRE -960 2704 -960 2640
WIRE -1584 2800 -1584 2768
WIRE -1328 2800 -1328 2768
WIRE -1328 2800 -1584 2800
WIRE -1216 2800 -1216 2768
WIRE -960 2800 -960 2768
WIRE -960 2800 -1216 2800
WIRE -1584 2832 -1584 2800
WIRE -1216 2832 -1216 2800
WIRE -1488 2896 -1584 2896
WIRE -1328 2896 -1408 2896
WIRE -1120 2896 -1216 2896
WIRE -960 2896 -1040 2896
WIRE -1584 2944 -1584 2896
WIRE -1216 2944 -1216 2896
WIRE -1328 2960 -1328 2896
WIRE -960 2960 -960 2896
WIRE -1584 3056 -1584 3024
WIRE -1328 3056 -1328 3024
WIRE -1328 3056 -1584 3056
WIRE -1216 3056 -1216 3024
WIRE -960 3056 -960 3024
WIRE -960 3056 -1216 3056
WIRE -1584 3088 -1584 3056
WIRE -1216 3088 -1216 3056
WIRE -1120 3152 -1216 3152
WIRE -960 3152 -1040 3152
WIRE -1488 3168 -1584 3168
WIRE -1328 3168 -1408 3168
WIRE -1216 3200 -1216 3152
WIRE -1584 3216 -1584 3168
WIRE -960 3216 -960 3152
WIRE -1328 3232 -1328 3168
WIRE -1216 3312 -1216 3280
WIRE -960 3312 -960 3280
WIRE -960 3312 -1216 3312
WIRE -1584 3328 -1584 3296
WIRE -1328 3328 -1328 3296
WIRE -1328 3328 -1584 3328
WIRE -1216 3344 -1216 3312
WIRE -1584 3360 -1584 3328
WIRE -1120 3408 -1216 3408
WIRE -960 3408 -1040 3408
WIRE -1488 3424 -1584 3424
WIRE -1328 3424 -1408 3424
WIRE -1216 3456 -1216 3408
WIRE -1584 3472 -1584 3424
WIRE -960 3472 -960 3408
WIRE -1328 3488 -1328 3424
WIRE -1216 3568 -1216 3536
WIRE -960 3568 -960 3536
WIRE -960 3568 -1216 3568
WIRE -1584 3584 -1584 3552
WIRE -1328 3584 -1328 3552
WIRE -1328 3584 -1584 3584
WIRE -1216 3600 -1216 3568
WIRE -1584 3616 -1584 3584
WIRE -1488 3664 -1584 3664
WIRE -1328 3664 -1408 3664
WIRE -1120 3664 -1216 3664
WIRE -960 3664 -1040 3664
WIRE -1584 3712 -1584 3664
WIRE -1216 3712 -1216 3664
WIRE -1328 3728 -1328 3664
WIRE -960 3728 -960 3664
WIRE -1584 3824 -1584 3792
WIRE -1328 3824 -1328 3792
WIRE -1328 3824 -1584 3824
WIRE -1216 3824 -1216 3792
WIRE -960 3824 -960 3792
WIRE -960 3824 -1216 3824
WIRE -1584 3856 -1584 3824
WIRE -1216 3856 -1216 3824
FLAG -320 432 G
FLAG -320 576 S
FLAG -1280 592 D
FLAG -1280 400 S
FLAG -1168 592 A
FLAG -1168 400 K
FLAG -192 912 IN+
IOPIN -192 912 In
FLAG -192 784 IN-
IOPIN -192 784 In
FLAG 160 640 S
FLAG 288 640 D
FLAG 832 912 OUT-
IOPIN 832 912 In
FLAG 832 784 OUT+
IOPIN 832 784 In
FLAG 320 640 A
FLAG 448 640 K
FLAG 816 944 0
FLAG 192 592 G
FLAG -880 768 IN+
IOPIN -880 768 In
FLAG -880 928 IN-
IOPIN -880 928 In
FLAG -688 928 OUT-
IOPIN -688 928 In
FLAG -688 768 OUT+
IOPIN -688 768 In
FLAG 176 1408 0
FLAG 416 1408 0
FLAG -304 1504 0
FLAG -304 1328 VCC
FLAG 224 1296 VCC
FLAG 224 1360 0
FLAG 416 1328 vin_sen
FLAG 144 1616 0
FLAG 400 1600 0
FLAG 192 1504 VCC
FLAG 192 1568 0
FLAG 400 1536 Iin_sen
FLAG 1152 1328 Vout_sen
FLAG 720 1616 0
FLAG 768 1504 VCC
FLAG 768 1568 0
FLAG 976 1536 Iout_sen
FLAG 144 1408 0
FLAG 368 1408 0
FLAG 352 1600 0
FLAG 1152 1392 0
FLAG 1104 1392 0
FLAG 976 1600 0
FLAG 928 1600 0
FLAG 848 1408 0
FLAG 896 1296 VCC
FLAG 896 1360 0
FLAG 816 1408 0
FLAG -1216 880 0
FLAG -1216 3344 0
FLAG -1216 3600 0
FLAG -960 3408 Pout
FLAG -960 3152 Pin
FLAG -1216 3856 0
FLAG -960 3664 Eff
FLAG -1584 2832 0
FLAG -1328 2640 Pmos
FLAG -1584 3088 0
FLAG -1328 2896 Pdiode
FLAG -1216 2832 0
FLAG -960 2640 PLi
FLAG -1216 3088 0
FLAG -960 2896 PLo
FLAG -1584 3360 0
FLAG -1328 3168 PCi
FLAG -1584 3616 0
FLAG -1328 3424 PCc
FLAG -1584 3856 0
FLAG -1328 3664 PCo
FLAG -640 432 driver_out
SYMBOL diode -544 496 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL diode -400 368 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -384 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4.7
SYMBOL res -448 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 4.7
SYMBOL res -368 448 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -576 800 R0
SYMATTR InstName Rout
SYMATTR Value {Ro}
SYMBOL res -1296 400 R0
SYMATTR InstName R5
SYMATTR Value 10
SYMBOL cap -1296 512 R0
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res -1184 400 R0
SYMATTR InstName R6
SYMATTR Value 10
SYMBOL cap -1184 512 R0
SYMATTR InstName C5
SYMATTR Value 10n
SYMBOL ind2 160 656 M0
SYMATTR InstName Li
SYMATTR Value 33e-6
SYMATTR SpiceLine Rser=20m
SYMATTR Type ind
SYMBOL cap -128 816 M0
SYMATTR InstName Ci
SYMATTR Value 100u
SYMATTR SpiceLine Rser=1m
SYMBOL ind2 448 656 R0
SYMATTR InstName Lo
SYMATTR Value 33e-6
SYMATTR SpiceLine Rser=20m
SYMATTR Type ind
SYMBOL cap 800 800 M0
SYMATTR InstName Co
SYMATTR Value 33u
SYMATTR SpiceLine Rser=1m
SYMBOL cap 336 544 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cc
SYMATTR Value 10e-6
SYMATTR SpiceLine Rser=1m
SYMBOL res 624 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 500u
SYMBOL res -128 928 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 500u
SYMBOL MiniSyms4\\voltage- -688 496 R0
WINDOW 3 -18 -90 VRight 0
WINDOW 123 0 0 Left 0
WINDOW 39 7 17 Left 0
SYMATTR Value PULSE(0 15 0 1n 1n {D*Tsw} {Tsw})
SYMATTR SpiceLine Rser=100m Cpar=100n
SYMATTR InstName Driver
SYMBOL MiniSyms4\\res- 112 1344 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 10k
SYMATTR InstName R7
SYMBOL MiniSyms4\\res- 80 1312 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 10k
SYMATTR InstName R8
SYMBOL MiniSyms4\\res- 16 800 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R12
SYMBOL MiniSyms4\\res- 176 1264 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R13
SYMBOL MiniSyms4\\res- 176 1392 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R14
SYMBOL voltage -304 1360 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=1u
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL MiniSyms4\\res- 16 848 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R15
SYMBOL MiniSyms4\\res- 416 1376 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R16
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 224 1328 R0
SYMATTR InstName U2
SYMBOL MiniSyms4\\res- 144 1472 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 100k
SYMATTR InstName R9
SYMBOL MiniSyms4\\res- 144 1584 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 100k
SYMATTR InstName R17
SYMBOL MiniSyms4\\res- 400 1568 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R18
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 192 1536 R0
SYMATTR InstName U1
SYMBOL MiniSyms4\\res- 720 1472 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 100k
SYMATTR InstName R24
SYMBOL MiniSyms4\\res- 720 1600 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 100k
SYMATTR InstName R25
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 768 1536 R0
SYMATTR InstName U5
SYMBOL MiniSyms4\\res- 672 800 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 47k
SYMATTR InstName R27
SYMBOL MiniSyms4\\res- 672 848 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R28
SYMBOL MiniSyms4\\res- 656 1520 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 100
SYMATTR InstName R29
SYMBOL MiniSyms4\\res- 688 1552 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 100
SYMATTR InstName R30
SYMBOL MiniSyms4\\res- 48 1520 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 100
SYMATTR InstName R31
SYMBOL MiniSyms4\\res- 0 1552 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 100
SYMATTR InstName R32
SYMBOL MiniSyms4\\cap- 144 1280 R0
SYMATTR Value 1n
SYMATTR InstName C1
SYMBOL MiniSyms4\\cap- 144 1392 R0
SYMATTR Value 1n
SYMATTR InstName C2
SYMBOL MiniSyms4\\cap- 368 1392 R0
SYMATTR Value 1u
SYMATTR InstName C3
SYMBOL MiniSyms4\\res- 320 1328 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 16
SYMATTR InstName R4
SYMBOL MiniSyms4\\cap- 352 1584 R0
SYMATTR Value 1u
SYMATTR InstName C6
SYMBOL MiniSyms4\\res- 304 1536 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 16
SYMATTR InstName R33
SYMBOL MiniSyms4\\res- 1152 1360 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R34
SYMBOL MiniSyms4\\cap- 1104 1376 R0
SYMATTR Value 1u
SYMATTR InstName C12
SYMBOL MiniSyms4\\res- 1056 1328 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 16
SYMATTR InstName R35
SYMBOL MiniSyms4\\res- 976 1568 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R26
SYMBOL MiniSyms4\\cap- 928 1584 R0
SYMATTR Value 1u
SYMATTR InstName C13
SYMBOL MiniSyms4\\res- 880 1536 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 16
SYMATTR InstName R36
SYMBOL MiniSyms4\\res- 784 1344 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 10k
SYMATTR InstName R19
SYMBOL MiniSyms4\\res- 752 1312 R90
WINDOW 3 8 0 VTop 2
WINDOW 0 -8 0 VBottom 2
SYMATTR Value 10k
SYMATTR InstName R20
SYMBOL MiniSyms4\\res- 848 1264 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R21
SYMBOL MiniSyms4\\res- 848 1392 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R22
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 896 1328 R0
SYMATTR InstName U3
SYMBOL MiniSyms4\\cap- 816 1280 R0
SYMATTR Value 1n
SYMATTR InstName C14
SYMBOL MiniSyms4\\cap- 816 1392 R0
SYMATTR Value 1n
SYMATTR InstName C15
SYMBOL PV_cplx -1104 848 M0
WINDOW 3 236 59 Invisible 1
SYMATTR Value PV_cplx voc={Voc} isc={Isc} vmp={Vmp} imp={Imp} tk_voc={-tk_voc} tk_isc={tk_isc}
SYMATTR InstName PV
SYMBOL MiniSyms4\\voltage- -1216 864 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Irradiance1
SYMATTR Value {G}
SYMBOL diode -1008 880 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4007
SYMBOL voltage -992 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName In
SYMATTR Value 0
SYMBOL voltage -672 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName Out
SYMATTR Value 0
SYMBOL nmos 272 592 R90
SYMATTR InstName M1
SYMATTR Value FDB2532
SYMBOL nmos 432 592 R90
SYMATTR InstName M2
SYMATTR Value FDB2532
SYMBOL bv -1216 3184 R0
SYMATTR InstName B1
SYMATTR Value V=I(In)*V(IN+,IN-)
SYMBOL res -1024 3136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 160
SYMBOL cap -976 3216 R0
SYMATTR InstName C7
SYMATTR Value 1u
SYMBOL bv -1216 3440 R0
SYMATTR InstName B2
SYMATTR Value V=I(Out)*V(OUT+)
SYMBOL res -1024 3392 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 160
SYMBOL cap -976 3472 R0
SYMATTR InstName C10
SYMATTR Value 1u
SYMBOL bv -1216 3696 R0
SYMATTR InstName B3
SYMATTR Value V=V(Pout)/V(Pin)
SYMBOL res -1024 3648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R38
SYMATTR Value 160
SYMBOL cap -976 3728 R0
SYMATTR InstName C11
SYMATTR Value 1u
SYMBOL bv -1584 2672 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(D,S)*Id(M1)+V(G,S)*Ig(M1)
SYMATTR InstName B4
SYMBOL res -1392 2624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R39
SYMATTR Value 160
SYMBOL cap -1344 2704 R0
SYMATTR InstName C16
SYMATTR Value 1u
SYMBOL bv -1584 2928 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,D)*Id(M2)
SYMATTR InstName B5
SYMBOL res -1392 2880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R40
SYMATTR Value 160
SYMBOL cap -1344 2960 R0
SYMATTR InstName C17
SYMATTR Value 1u
SYMBOL bv -1216 2672 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(S,IN-)*I(Li)
SYMATTR InstName B6
SYMBOL res -1024 2624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R41
SYMATTR Value 160
SYMBOL cap -976 2704 R0
SYMATTR InstName C18
SYMATTR Value 1u
SYMBOL bv -1216 2928 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,OUT+)*I(Lo)
SYMATTR InstName B7
SYMBOL res -1024 2880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R42
SYMATTR Value 160
SYMBOL cap -976 2960 R0
SYMATTR InstName C19
SYMATTR Value 1u
SYMBOL bv -1584 3200 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(IN-,IN+)*I(Ci)
SYMATTR InstName B8
SYMBOL res -1392 3152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R43
SYMATTR Value 160
SYMBOL cap -1344 3232 R0
SYMATTR InstName C8
SYMATTR Value 1u
SYMBOL bv -1584 3456 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,S)*I(Cc)
SYMATTR InstName B9
SYMBOL res -1392 3408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R44
SYMATTR Value 160
SYMBOL cap -1344 3488 R0
SYMATTR InstName C9
SYMATTR Value 1u
SYMBOL bv -1584 3696 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(OUT+)*I(Co)
SYMATTR InstName B10
SYMBOL res -1392 3648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R45
SYMATTR Value 160
SYMBOL cap -1344 3728 R0
SYMATTR InstName C20
SYMATTR Value 1u
TEXT -880 1112 Left 2 !.param tstart {1.6m}\n.param tend {2m}\n.tran 0 {tend} {tstart}
TEXT 160 368 Left 2 ;OUT- Standard Floating Half-Bridge
TEXT -1344 736 Right 2 !.include pvlib.cir
TEXT -1504 968 Left 2 !.param G=1000\n;.step param G list 200 400 600 800 1000 1200
TEXT -1496 1096 Left 2 !; Optimal Operating Point: MPPT\n.param Vi {Vmp}\n.param Ii {Imp}\n.param Pi {Vmp * Imp}\n.param Ri {Vi/Ii}\n.param Eff=1\n.param Po {Eff * (G/1000) * Pi}\n.param Vo {(Po * Ro)**(1/2)}\n.param Io {Vo / Ro}\n.param D={(Vo/(Vi+Vo))}
TEXT -1504 776 Left 2 !.param Voc 24.9\n.param Isc 9.65\n.param Vmp 20.3\n.param Imp 8.75\n.param tk_voc -0.0031\n.param tk_isc 0.0005
TEXT -768 976 Left 2 !;.param RO 5\n.step param RO list 1 2 3 4 5 10 15 20 25 30
TEXT -768 608 Left 2 !;.step param fsw 30e3 60e3 5e3\n.param fsw {40e3}\n.param Tsw {1/fsw}
TEXT -2376 1280 Left 2 !; Input\n.meas Iin_rms RMS I(In) FROM time > 10m\n.meas Iin_avg AVG I(In) FROM time > 10m\n.meas Iin_pkpk PP I(In) FROM time > 10m\n \n.meas Vin_rms RMS V(IN+,IN-) FROM time > 10m\n.meas Vin_avg AVG V(IN+,IN-) FROM time > 10m\n.meas Vin_pkpk PP V(IN+,IN-) FROM time > 10m\n \n\n; Output\n.meas Iout_rms RMS I(Out) FROM time > 10m\n.meas Iout_avg AVG I(Out) FROM time > 10m\n.meas Iout_pkpk PP I(Out) FROM time > 10m\n \n.meas Vout_rms RMS V(OUT+) FROM time > 10m\n.meas Vout_avg AVG V(OUT+) FROM time > 10m\n.meas Vout_pkpk PP V(OUT+) FROM time > 10m\n \n\n; Input Capacitor\n.meas ICi_pkpk PP I(Ci) FROM time > 10m\n.meas ICi_avg AVG I(Ci) FROM time > 10m\n.meas ICi_rms RMS I(Ci) FROM time > 10m\n \n.meas VCi_avg AVG V(IN-,IN+) FROM time > 10m\n.meas VCi_rms RMS V(IN-,IN+) FROM time > 10m\n.meas VCi_pkpk PP V(IN-,IN+) FROM time > 10m\n \n\n; Output Capacitor\n.meas ICo_pkpk PP I(Co) FROM time > 10m\n.meas ICo_avg AVG I(Co) FROM time > 10m\n.meas ICo_rms RMS I(Co) FROM time > 10m\n \n.meas VCo_pkpk PP V(OUT+) FROM time > 10m\n.meas VCo_avg AVG V(OUT+) FROM time > 10m\n.meas VCo_rms RMS V(OUT+) FROM time > 10m\n \n\n; Coupling Capacitor\n.meas ICc_pkpk PP I(Cc) FROM time > 10m\n.meas ICc_avg AVG I(Cc) FROM time > 10m\n.meas ICc_rms RMS I(Cc) FROM time > 10m\n \n.meas VCc_pkpk PP V(K,S) FROM time > 10m\n.meas VCc_avg AVG V(K,S) FROM time > 10m\n.meas VCc_rms RMS V(K,S) FROM time > 10m\n \n\n; Output Inductor\n.meas ILo_pkpk PP I(Lo) FROM time > 10m\n.meas ILo_avg AVG I(Lo) FROM time > 10m\n.meas ILo_rms RMS I(Lo) FROM time > 10m\n \n.meas VLo_pkpk PP V(K,OUT+) FROM time > 10m\n.meas VLo_avg AVG V(K,OUT+) FROM time > 10m\n.meas VLo_rms RMS V(K,OUT+) FROM time > 10m\n \n\n; Input Inductor\n.meas ILi_pkpk PP I(Li) FROM time > 10m\n.meas ILi_avg AVG I(Li) FROM time > 10m\n.meas ILi_rms RMS I(Li) FROM time > 10m\n \n.meas VLi_pkpk PP V(S,In-) FROM time > 10m\n.meas VLi_avg AVG V(S,In-) FROM time > 10m\n.meas VLi_rms RMS V(S,In-) FROM time > 10m\n \n\n; Mosfet\n.meas Imos_avg AVG I(M1) FROM time > 10m\n.meas Imos_rms RMS I(M1) FROM time > 10m\n.meas Imos_pkpk PP I(M1) FROM time > 10m\n \n.meas Vmos_avg AVG V(D,S) FROM time > 10m\n.meas Vmos_rms RMS V(D,S) FROM time > 10m\n.meas Vmos_pkpk PP V(D,S) FROM time > 10m\n \n\n; Diode\n.meas Idiode_avg AVG I(M2) FROM time > 10m\n.meas Idiode_rms RMS I(M2) FROM time > 10m\n.meas Idiode_pkpk PP I(M2) FROM time > 10m\n \n.meas Vdiode_avg AVG V(K,A) FROM time > 10m\n.meas Vdiode_rms RMS V(K,A) FROM time > 10m\n.meas Vdiode_pkpk PP V(K,A) FROM time > 10m\n \n\n; Power and Efficiency\n.meas Pin_avg param Iin_rms*Vin_rms FROM time > 10m\n.meas Pout_avg param Iout_rms*Vout_rms FROM time > 10m\n.meas Pmos_avg param Imos_rms*Vmos_rms FROM time > 10m\n.meas Pdiode_avg param Idiode_rms*Vdiode_rms FROM time > 10m\n.meas PCi_avg param ICi_rms*VCi_rms FROM time > 10m\n.meas PCc_avg param ICc_rms*VCc_rms FROM time > 10m\n.meas PCo_avg param ICo_rms*VCo_rms FROM time > 10m\n.meas PLi_avg param ILi_rms*VLi_rms FROM time > 10m\n.meas PLo_avg param ILo_rms*VLo_rms FROM time > 10m\n.meas Eff param Pout_avg/Pin_avg FROM time > 10m
RECTANGLE Normal -800 1040 -1536 704 2
RECTANGLE Normal 1232 1680 -368 1200 2
RECTANGLE Normal -320 1040 -784 704 2
