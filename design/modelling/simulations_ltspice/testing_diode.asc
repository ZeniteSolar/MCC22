Version 4
SHEET 1 4400 3988
WIRE -2592 -528 -2624 -528
WIRE -2496 -528 -2528 -528
WIRE -2400 -528 -2416 -528
WIRE -2304 -528 -2336 -528
WIRE -2608 -432 -2640 -432
WIRE -2432 -432 -2528 -432
WIRE -2400 -432 -2432 -432
WIRE -2304 -432 -2304 -528
WIRE -2304 -432 -2336 -432
WIRE -2272 -432 -2304 -432
WIRE -2176 -432 -2208 -432
WIRE -2128 -432 -2176 -432
WIRE -2640 -416 -2640 -432
WIRE -2432 -416 -2432 -432
WIRE -2304 -400 -2304 -432
WIRE -2176 -400 -2176 -432
WIRE -2560 -336 -2592 -336
WIRE -2640 -304 -2640 -336
WIRE -2432 -304 -2432 -320
WIRE -2432 -304 -2640 -304
WIRE -2400 -304 -2432 -304
WIRE -2304 -304 -2304 -336
WIRE -2304 -304 -2320 -304
WIRE -2176 -304 -2176 -336
WIRE -2176 -304 -2304 -304
WIRE -2128 -304 -2176 -304
WIRE -2640 -272 -2640 -304
WIRE -2112 -80 -2192 -80
WIRE -1936 -80 -2112 -80
WIRE -1744 -80 -1856 -80
WIRE -2112 -32 -2112 -80
WIRE -1808 -32 -2112 -32
WIRE -1744 -32 -1744 -80
WIRE -1696 -32 -1744 -32
WIRE -1808 -16 -1808 -32
WIRE -1872 32 -1904 32
WIRE -1808 96 -1808 80
WIRE -1680 96 -1808 96
WIRE -1600 96 -1680 96
WIRE -1520 96 -1600 96
WIRE -1424 96 -1440 96
WIRE -1392 96 -1424 96
WIRE -1312 96 -1392 96
WIRE -1280 96 -1312 96
WIRE -1808 112 -1808 96
WIRE -2192 128 -2192 -80
WIRE -1392 144 -1392 96
WIRE -1952 160 -2080 160
WIRE -1904 160 -1904 32
WIRE -1904 160 -1952 160
WIRE -1872 160 -1904 160
WIRE -1312 160 -1312 96
WIRE -2592 176 -2592 -336
WIRE -2592 176 -2688 176
WIRE -2496 176 -2592 176
WIRE -2448 176 -2496 176
WIRE -2352 176 -2368 176
WIRE -2112 192 -2112 -32
WIRE -2112 192 -2128 192
WIRE -1600 192 -1600 96
WIRE -1584 192 -1600 192
WIRE -1424 192 -1424 96
WIRE -1424 192 -1440 192
WIRE -2688 208 -2688 176
WIRE -2688 272 -2688 240
WIRE -2368 272 -2688 272
WIRE -2352 272 -2368 272
WIRE -2112 272 -2128 272
WIRE -2080 272 -2080 160
WIRE -2080 272 -2112 272
WIRE -2064 272 -2080 272
WIRE -1952 272 -1984 272
WIRE -1920 272 -1952 272
WIRE -1808 272 -1808 208
WIRE -1808 272 -1840 272
WIRE -1696 272 -1808 272
WIRE -1664 272 -1696 272
WIRE -1392 272 -1392 224
WIRE -1392 272 -1584 272
WIRE -1312 272 -1312 224
WIRE -1312 272 -1392 272
WIRE -1280 272 -1312 272
WIRE -2688 320 -2688 272
WIRE -2368 336 -2368 272
WIRE -2336 336 -2368 336
WIRE -2112 336 -2112 272
WIRE -2112 336 -2256 336
WIRE -2368 368 -2368 336
WIRE -2224 368 -2368 368
WIRE -2112 368 -2112 336
WIRE -2112 368 -2160 368
WIRE -1952 384 -1952 272
WIRE -1696 384 -1952 384
WIRE -624 400 -624 384
WIRE -496 400 -496 384
WIRE -624 480 -640 480
WIRE -496 480 -512 480
WIRE -624 496 -624 480
WIRE -496 496 -496 480
WIRE 656 560 432 560
WIRE 944 560 720 560
WIRE -624 576 -624 560
WIRE -496 576 -496 560
WIRE 816 672 800 672
WIRE 816 688 816 672
WIRE 48 736 -96 736
WIRE 192 736 48 736
WIRE 272 736 192 736
WIRE 432 736 432 560
WIRE 432 736 352 736
WIRE 464 736 432 736
WIRE 480 736 464 736
WIRE 592 736 576 736
WIRE 624 736 592 736
WIRE 688 736 656 736
WIRE 720 736 688 736
WIRE 768 736 752 736
WIRE 800 736 800 672
WIRE 800 736 768 736
WIRE 896 736 880 736
WIRE 928 736 896 736
WIRE 944 736 944 560
WIRE 944 736 928 736
WIRE 1024 736 944 736
WIRE 1184 736 1104 736
WIRE 1328 736 1184 736
WIRE 1472 736 1328 736
WIRE -976 768 -1008 768
WIRE -880 768 -896 768
WIRE -656 768 -688 768
WIRE -560 768 -576 768
WIRE 48 800 48 736
WIRE 1328 800 1328 736
WIRE -1008 816 -1008 768
WIRE -992 816 -1008 816
WIRE -560 816 -560 768
WIRE -1008 832 -1008 816
WIRE -1008 832 -1040 832
WIRE 192 832 192 736
WIRE 1184 832 1184 736
WIRE -1168 848 -1216 848
WIRE 496 848 496 768
WIRE 560 848 560 768
WIRE 816 848 816 768
WIRE 880 848 880 768
WIRE -1008 864 -1040 864
WIRE 48 864 48 832
WIRE 64 864 48 864
WIRE 1328 864 1328 832
WIRE 1328 864 1312 864
WIRE -1008 880 -1008 864
WIRE -992 880 -1008 880
WIRE 64 896 48 896
WIRE 1328 896 1312 896
WIRE -1008 928 -1008 880
WIRE -880 928 -1008 928
WIRE -560 928 -560 896
WIRE -560 928 -688 928
WIRE -64 976 -96 976
WIRE 48 976 48 896
WIRE 48 976 16 976
WIRE 192 976 192 896
WIRE 192 976 48 976
WIRE 688 976 688 736
WIRE 688 976 192 976
WIRE 1184 976 1184 896
WIRE 1184 976 688 976
WIRE 1328 976 1328 896
WIRE 1328 976 1184 976
WIRE 1360 976 1328 976
WIRE 1456 976 1440 976
WIRE 1472 976 1456 976
WIRE 1456 1008 1456 976
WIRE -224 1536 -320 1536
WIRE -64 1536 -144 1536
WIRE 144 1536 48 1536
WIRE 304 1536 224 1536
WIRE 512 1536 416 1536
WIRE 672 1536 592 1536
WIRE -320 1584 -320 1536
WIRE 48 1584 48 1536
WIRE 416 1584 416 1536
WIRE -64 1600 -64 1536
WIRE 304 1600 304 1536
WIRE 672 1600 672 1536
WIRE -320 1696 -320 1664
WIRE -64 1696 -64 1664
WIRE -64 1696 -320 1696
WIRE 48 1696 48 1664
WIRE 304 1696 304 1664
WIRE 304 1696 48 1696
WIRE 416 1696 416 1664
WIRE 672 1696 672 1664
WIRE 672 1696 416 1696
WIRE -1312 1712 -1360 1712
WIRE -1136 1712 -1184 1712
WIRE -320 1728 -320 1696
WIRE 48 1728 48 1696
WIRE 416 1728 416 1696
WIRE -1360 1760 -1408 1760
WIRE -1408 1792 -1440 1792
WIRE -1360 1792 -1360 1760
WIRE -224 1792 -320 1792
WIRE -64 1792 -144 1792
WIRE 144 1792 48 1792
WIRE 304 1792 224 1792
WIRE 512 1792 416 1792
WIRE 672 1792 592 1792
WIRE -1440 1840 -1440 1792
WIRE -1440 1840 -1488 1840
WIRE -1424 1840 -1440 1840
WIRE -1312 1840 -1312 1712
WIRE -1312 1840 -1344 1840
WIRE -1264 1840 -1312 1840
WIRE -1136 1840 -1136 1712
WIRE -1136 1840 -1184 1840
WIRE -1104 1840 -1136 1840
WIRE -992 1840 -1024 1840
WIRE -320 1840 -320 1792
WIRE 48 1840 48 1792
WIRE 416 1840 416 1792
WIRE -64 1856 -64 1792
WIRE 304 1856 304 1792
WIRE 672 1856 672 1792
WIRE -896 1872 -944 1872
WIRE -1312 1920 -1360 1920
WIRE -1136 1920 -1184 1920
WIRE -784 1920 -816 1920
WIRE -320 1952 -320 1920
WIRE -64 1952 -64 1920
WIRE -64 1952 -320 1952
WIRE 48 1952 48 1920
WIRE 304 1952 304 1920
WIRE 304 1952 48 1952
WIRE 416 1952 416 1920
WIRE 672 1952 672 1920
WIRE 672 1952 416 1952
WIRE -1360 1968 -1408 1968
WIRE -320 1984 -320 1952
WIRE 48 1984 48 1952
WIRE 416 1984 416 1952
WIRE -1408 2000 -1440 2000
WIRE -1360 2000 -1360 1968
WIRE -1440 2048 -1440 2000
WIRE -1440 2048 -1488 2048
WIRE -1424 2048 -1440 2048
WIRE -1312 2048 -1312 1920
WIRE -1312 2048 -1344 2048
WIRE -1264 2048 -1312 2048
WIRE -1136 2048 -1136 1920
WIRE -1136 2048 -1184 2048
WIRE -1104 2048 -1136 2048
WIRE -992 2048 -992 1840
WIRE -992 2048 -1024 2048
WIRE -944 2048 -944 1872
WIRE -944 2048 -992 2048
WIRE -896 2048 -944 2048
WIRE -784 2048 -784 1920
WIRE -784 2048 -816 2048
WIRE -752 2048 -784 2048
WIRE -624 2048 -672 2048
WIRE -544 2048 -624 2048
WIRE 144 2048 48 2048
WIRE 304 2048 224 2048
WIRE 512 2048 416 2048
WIRE 672 2048 592 2048
WIRE -224 2064 -320 2064
WIRE -64 2064 -144 2064
WIRE 48 2096 48 2048
WIRE 416 2096 416 2048
WIRE -320 2112 -320 2064
WIRE 304 2112 304 2048
WIRE 672 2112 672 2048
WIRE -64 2128 -64 2064
WIRE -944 2176 -944 2048
WIRE -816 2176 -944 2176
WIRE -624 2176 -624 2048
WIRE -624 2176 -752 2176
WIRE 48 2208 48 2176
WIRE 304 2208 304 2176
WIRE 304 2208 48 2208
WIRE 416 2208 416 2176
WIRE 672 2208 672 2176
WIRE 672 2208 416 2208
WIRE -320 2224 -320 2192
WIRE -64 2224 -64 2192
WIRE -64 2224 -320 2224
WIRE 48 2240 48 2208
WIRE 416 2240 416 2208
WIRE -320 2256 -320 2224
WIRE 144 2304 48 2304
WIRE 304 2304 224 2304
WIRE -224 2320 -320 2320
WIRE -64 2320 -144 2320
WIRE 48 2352 48 2304
WIRE -320 2368 -320 2320
WIRE 304 2368 304 2304
WIRE -64 2384 -64 2320
WIRE -1104 2400 -1184 2400
WIRE -992 2400 -1024 2400
WIRE -896 2432 -944 2432
WIRE 48 2464 48 2432
WIRE 304 2464 304 2432
WIRE 304 2464 48 2464
WIRE -784 2480 -816 2480
WIRE -320 2480 -320 2448
WIRE -64 2480 -64 2448
WIRE -64 2480 -320 2480
WIRE 48 2496 48 2464
WIRE -320 2512 -320 2480
WIRE -224 2560 -320 2560
WIRE -64 2560 -144 2560
WIRE 144 2560 48 2560
WIRE 304 2560 224 2560
WIRE 512 2560 416 2560
WIRE 672 2560 592 2560
WIRE -1104 2608 -1184 2608
WIRE -992 2608 -992 2400
WIRE -992 2608 -1024 2608
WIRE -944 2608 -944 2432
WIRE -944 2608 -992 2608
WIRE -896 2608 -944 2608
WIRE -784 2608 -784 2480
WIRE -784 2608 -816 2608
WIRE -752 2608 -784 2608
WIRE -544 2608 -624 2608
WIRE -320 2608 -320 2560
WIRE 48 2608 48 2560
WIRE 416 2608 416 2560
WIRE -64 2624 -64 2560
WIRE 304 2624 304 2560
WIRE 672 2624 672 2560
WIRE -320 2720 -320 2688
WIRE -64 2720 -64 2688
WIRE -64 2720 -320 2720
WIRE 48 2720 48 2688
WIRE 304 2720 304 2688
WIRE 304 2720 48 2720
WIRE 416 2720 416 2688
WIRE 672 2720 672 2688
WIRE 672 2720 416 2720
WIRE -944 2736 -944 2608
WIRE -816 2736 -944 2736
WIRE -624 2736 -624 2608
WIRE -624 2736 -752 2736
WIRE -320 2752 -320 2720
WIRE 48 2752 48 2720
WIRE 416 2752 416 2720
FLAG -1280 96 G
FLAG -1280 272 S
FLAG -624 576 D
FLAG -624 384 S
FLAG -496 576 A
FLAG -496 384 K
FLAG -96 976 IN+
IOPIN -96 976 In
FLAG -96 736 IN-
IOPIN -96 736 In
FLAG 464 736 S
FLAG 592 736 D
FLAG 1472 976 OUT-
IOPIN 1472 976 In
FLAG 1472 736 OUT+
IOPIN 1472 736 In
FLAG 768 736 A
FLAG 928 736 K
FLAG 1456 1008 0
FLAG 496 688 G
FLAG -880 768 IN+
IOPIN -880 768 In
FLAG -880 928 IN-
IOPIN -880 928 In
FLAG -688 928 OUT-
IOPIN -688 928 In
FLAG -688 768 OUT+
IOPIN -688 768 In
FLAG -1216 880 0
FLAG 48 2240 0
FLAG 48 2496 0
FLAG 304 2304 Pout
FLAG 304 2048 Pin
FLAG 48 2752 0
FLAG 304 2560 Eff
FLAG -320 1728 0
FLAG -64 1536 Pmos
FLAG -320 1984 0
FLAG -64 1792 Pdiode
FLAG 48 1728 0
FLAG 304 1536 PLi
FLAG 48 1984 0
FLAG 304 1792 PLo
FLAG -320 2256 0
FLAG -64 2064 PCi
FLAG -320 2512 0
FLAG -64 2320 PCc
FLAG -320 2752 0
FLAG -64 2560 PCo
FLAG -2496 176 HI
FLAG -896 1872 HeatSink
FLAG -544 2048 0
FLAG -1488 1840 0
FLAG -1184 1712 M1Case
FLAG -1360 1712 M1Junction
FLAG -1408 1760 Pmos
FLAG -1488 2048 0
FLAG -1184 1920 M1Case
FLAG -1360 1920 M2Junction
FLAG -1408 1968 Pdiode
FLAG -816 1920 Amb
FLAG 560 848 M1Tj
FLAG 880 848 M2Tj
FLAG -896 2432 HeatSink2
FLAG -1184 2400 M1Case_
FLAG -1184 2608 M1Case_
FLAG -816 2480 Amb
FLAG 496 848 M1Case_
FLAG 816 848 M1Case_
FLAG -544 2608 0
FLAG 416 2752 0
FLAG 672 2560 Ploss
FLAG 416 1728 0
FLAG 672 1536 PsbubMos
FLAG -640 480 snb_M1
FLAG -512 480 snb_M2
FLAG 416 1984 0
FLAG 672 1792 PsbubDiode
FLAG 416 2240 0
FLAG 672 2048 Pshunts
FLAG -1696 -32 VCC
FLAG -1696 384 VEE
FLAG -1680 96 HO
FLAG -1952 160 TP_IN
FLAG -2688 320 0
FLAG -2128 -432 VCC
FLAG -2128 -304 VEE
FLAG -1696 272 VS
FLAG -2624 -528 OUT+
FLAG -2640 -272 0
SYMBOL res -1408 128 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -576 800 R0
SYMATTR InstName Rout
SYMATTR Value {Ro}
SYMBOL res -640 384 R0
SYMATTR InstName Rs_M1
SYMATTR Value {Rs}
SYMBOL cap -640 496 R0
SYMATTR InstName Cs_M1
SYMATTR Value {Cs}
SYMATTR SpiceLine Rser={Cs_esr}
SYMBOL ind2 368 752 M270
WINDOW 39 36 108 Left 2
WINDOW 40 36 136 Left 2
SYMATTR SpiceLine Rser={Li_esr}
SYMATTR SpiceLine2 IC={Ii}
SYMATTR InstName Li
SYMATTR Value {Li}
SYMATTR Type ind
SYMBOL cap 176 896 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
WINDOW 39 24 -17 Left 2
WINDOW 40 24 -43 Left 2
SYMATTR InstName Ci
SYMATTR Value {Ci}
SYMATTR SpiceLine Rser={Ci_esr}
SYMATTR SpiceLine2 IC={Vi}
SYMBOL ind2 1008 752 R270
WINDOW 39 36 108 Left 2
WINDOW 40 36 136 Left 2
SYMATTR SpiceLine Rser={Lo_esr}
SYMATTR SpiceLine2 IC={0.95*Io}
SYMATTR InstName Lo
SYMATTR Value {Lo}
SYMATTR Type ind
SYMBOL cap 1200 832 M0
WINDOW 39 28 81 Left 2
WINDOW 40 28 102 Left 2
SYMATTR SpiceLine Rser={Co_esr}
SYMATTR SpiceLine2 IC={0.95*Vo}
SYMATTR InstName Co
SYMATTR Value {Co}
SYMBOL cap 720 576 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
WINDOW 39 -28 32 VBottom 2
WINDOW 40 -56 32 VBottom 2
SYMATTR InstName Cc
SYMATTR Value {Cc}
SYMATTR SpiceLine Rser={Cc_esr}
SYMATTR SpiceLine2 IC={0.95*(Vi+Vo)}
SYMBOL res 1456 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RshuntOut
SYMATTR Value 1500u
SYMBOL res -80 992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RshuntIn
SYMATTR Value 1500u
SYMBOL MiniSyms4\\voltage- -2688 224 R0
WINDOW 3 -18 -90 VRight 0
WINDOW 123 0 0 Left 0
WINDOW 39 7 17 Left 0
SYMATTR Value PULSE(0 5 0 1n 1n {D*Tsw} {Tsw})
SYMATTR SpiceLine Rser=100m Cpar=100n
SYMATTR InstName Driver
SYMBOL MiniSyms4\\res- 48 816 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R12
SYMBOL MiniSyms4\\res- 48 880 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R15
SYMBOL MiniSyms4\\res- 1328 816 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 47k
SYMATTR InstName R27
SYMBOL MiniSyms4\\res- 1328 880 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R28
SYMBOL PV_cplx -1104 848 M0
WINDOW 3 236 59 Invisible 1
SYMATTR Value PV_cplx voc={Voc} isc={Isc} vmp={Vmp} imp={Imp} tk_voc={-tk_voc} tk_isc={tk_isc}
SYMATTR InstName PV
SYMBOL MiniSyms4\\voltage- -1216 864 M0
WINDOW 123 0 0 Left 0
WINDOW 39 11 39 Left 0
SYMATTR InstName Irradiance1
SYMATTR Value {G}
SYMBOL diode -1008 880 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4007
SYMBOL voltage -992 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName In
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMBOL voltage -672 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName Out
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMBOL bv 48 2080 R0
SYMATTR InstName B1
SYMATTR Value V=I(In)*V(IN+,IN-)
SYMBOL res 240 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 160
SYMBOL cap 288 2112 R0
SYMATTR InstName C7
SYMATTR Value 1u
SYMBOL bv 48 2336 R0
SYMATTR InstName B2
SYMATTR Value V=I(Out)*V(OUT+)
SYMBOL res 240 2288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 160
SYMBOL cap 288 2368 R0
SYMATTR InstName C10
SYMATTR Value 1u
SYMBOL bv 48 2592 R0
SYMATTR InstName B3
SYMATTR Value V=V(Pout)/V(Pin)
SYMBOL res 240 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R38
SYMATTR Value 160
SYMBOL cap 288 2624 R0
SYMATTR InstName C11
SYMATTR Value 10n
SYMBOL bv -320 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=I(M1)*V(D,S)
SYMATTR InstName B4
SYMBOL res -128 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R39
SYMATTR Value 160
SYMBOL cap -80 1600 R0
SYMATTR InstName C16
SYMATTR Value 1u
SYMBOL bv -320 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=I(M2)*V(K,D)
SYMATTR InstName B5
SYMBOL res -128 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R40
SYMATTR Value 160
SYMBOL cap -80 1856 R0
SYMATTR InstName C17
SYMATTR Value 1u
SYMBOL bv 48 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(S,IN-)*I(Li)
SYMATTR InstName B6
SYMBOL res 240 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R41
SYMATTR Value 160
SYMBOL cap 288 1600 R0
SYMATTR InstName C18
SYMATTR Value 1u
SYMBOL bv 48 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,OUT+)*I(Lo)
SYMATTR InstName B7
SYMBOL res 240 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R42
SYMATTR Value 160
SYMBOL cap 288 1856 R0
SYMATTR InstName C19
SYMATTR Value 1u
SYMBOL bv -320 2096 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(IN-,IN+)*I(Ci)
SYMATTR InstName B8
SYMBOL res -128 2048 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R43
SYMATTR Value 160
SYMBOL cap -80 2128 R0
SYMATTR InstName C8
SYMATTR Value 1u
SYMBOL bv -320 2352 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,S)*I(Cc)
SYMATTR InstName B9
SYMBOL res -128 2304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R44
SYMATTR Value 160
SYMBOL cap -80 2384 R0
SYMATTR InstName C9
SYMATTR Value 1u
SYMBOL bv -320 2592 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(OUT+)*I(Co)
SYMATTR InstName B10
SYMBOL res -128 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R45
SYMATTR Value 160
SYMBOL cap -80 2624 R0
SYMATTR InstName C20
SYMATTR Value 1u
SYMBOL voltage -768 2048 R270
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName Amb
SYMATTR Value {temp}
SYMBOL cap -816 2192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cthsa
SYMATTR Value 300n
SYMBOL MiniSyms4\\voltage- 640 736 R90
WINDOW 3 7 17 Left 0
WINDOW 123 0 0 Left 0
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName M1
SYMBOL MiniSyms4\\voltage- 736 736 R90
WINDOW 3 7 17 Left 0
WINDOW 123 0 0 Left 0
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName M2
SYMBOL res -1168 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthJC1
SYMATTR Value 0.8
SYMBOL res -1008 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS1
SYMATTR Value 2
SYMBOL g -1328 1840 R90
WINDOW 0 34 27 VLeft 2
WINDOW 3 35 103 VLeft 2
SYMATTR InstName G1
SYMATTR Value 1
SYMBOL res -1168 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthJC2
SYMATTR Value 0.8
SYMBOL res -1008 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS2
SYMATTR Value 2
SYMBOL g -1328 2048 R90
WINDOW 0 34 27 VLeft 2
WINDOW 3 35 103 VLeft 2
SYMATTR InstName G2
SYMATTR Value 1
SYMBOL res -800 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthSA
SYMATTR Value 10
SYMBOL cap -816 2752 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cthsa1
SYMATTR Value 300n
SYMBOL res -1008 2384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS3
SYMATTR Value 2
SYMBOL res -1008 2592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS4
SYMATTR Value 2
SYMBOL res -800 2592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthSA1
SYMATTR Value 10
SYMBOL bv 416 2592 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(Pmos)+V(Pdiode)+V(PLi)+V(PLo)+V(PCi)+V(PCc)+V(PCo)+V(PsbubMos)+V(PsbubDiode)
SYMATTR InstName B11
SYMBOL res 608 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 160
SYMBOL cap 656 2624 R0
SYMATTR InstName C1
SYMATTR Value 1u
SYMBOL bv 416 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(S,snb_M1)*I(Rs_M1)+V(snb_M1,D)*I(Cs_M1)
SYMATTR InstName B12
SYMBOL res 608 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 160
SYMBOL cap 656 1600 R0
SYMATTR InstName C2
SYMATTR Value 1u
SYMBOL res -512 384 R0
SYMATTR InstName Rs_M2
SYMATTR Value {Rs}
SYMBOL cap -512 496 R0
SYMATTR InstName Cs_M2
SYMATTR Value {Cs}
SYMATTR SpiceLine Rser={Cs_esr}
SYMBOL bv 416 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,snb_M2)*I(Rs_M2)+V(snb_M2,A)*I(Cs_M2)
SYMATTR InstName B13
SYMBOL res 608 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 160
SYMBOL cap 656 1856 R0
SYMATTR InstName C3
SYMATTR Value 1u
SYMBOL bv 416 2080 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=-V(D)*I(RshuntOut)+V(IN+,D)*I(RshuntIn)
SYMATTR InstName B14
SYMBOL res 608 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 160
SYMBOL cap 656 2112 R0
SYMATTR InstName C4
SYMATTR Value 1u
SYMBOL nmos 576 688 R90
SYMATTR InstName M3
SYMATTR Value IPB065N15N3
SYMBOL nmos 896 688 R90
SYMATTR InstName M4
SYMATTR Value IPB065N15N3
SYMBOL npn -1872 -16 R0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL pnp -1872 208 M180
WINDOW 0 58 67 Left 2
WINDOW 3 57 34 Left 2
SYMATTR InstName Q2
SYMATTR Value 2N2907
SYMBOL res -1536 80 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 4.7
SYMBOL res -1824 288 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 1u
SYMBOL cap -2192 -400 R0
SYMATTR InstName Cb
SYMATTR Value 1u
SYMBOL diode -2272 -416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 1
SYMATTR InstName Db
SYMATTR Value 1N4007
SYMBOL zener -2320 -336 M180
WINDOW 0 27 53 Left 2
WINDOW 3 24 0 Left 1
SYMATTR InstName DZb
SYMATTR Value BZX384B18
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -2400 -416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C6
SYMATTR Value 1u
SYMBOL res -2464 192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 100
SYMBOL OptoElec\\6n137 -2256 224 R0
SYMATTR InstName U1
SYMBOL res -1952 -96 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100
SYMBOL res -2240 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10Meg
SYMBOL res -2080 256 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 100
SYMBOL res -2304 -320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL diode -2592 -512 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 1
SYMATTR InstName Db2
SYMATTR Value 1N4007
SYMBOL res -2512 -512 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 1
SYMBOL cap -2400 -512 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C12
SYMATTR Value 1u
SYMBOL voltage -2640 -432 R0
SYMATTR InstName V1
SYMATTR Value 18
SYMBOL nmos -2480 -416 R0
SYMATTR InstName M5
SYMATTR Value FDB2532
SYMBOL res -2624 -416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL zener -1328 224 M180
WINDOW 0 27 53 Left 2
WINDOW 3 24 0 Left 1
SYMATTR InstName DZb1
SYMATTR Value BZX384B18
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -2576 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value 100
SYMBOL res -1536 176 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 4.7
SYMBOL diode -1520 176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 1
SYMATTR InstName D2
SYMATTR Value 1n4148
SYMBOL res -1568 288 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 1u
SYMBOL cap -2160 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 1p
TEXT -728 1208 Left 2 !.param tstart {0}\n.param tend {15m}\n.tran 0 {tend} {tstart}
TEXT 528 472 Left 2 ;OUT- Standard Floating Half-Bridge
TEXT -1336 744 Right 2 !.include pvlib.cir
TEXT -1504 968 Left 2 !.param G=1000\n;.step param G list 200 400 600 800 1000 1200
TEXT -1504 1064 Left 2 !; Optimal Operating Point: MPPT\n.param Vi {Vmp}\n.param Ii {Imp}\n.param Pi {Vmp * Imp}\n.param Ri {Vi/Ii}\n.param Eff=1\n.param Po {Eff * (G/1000) * Pi}\n.param Vo {(Po * Ro)**(1/2)}\n.param Io {Vo / Ro}\n.param D={(Vo/(Vi+Vo))}
TEXT -768 976 Left 2 !.param RO 6\n;.step param RO list 0.5 1 4 20 30 100
TEXT -2696 472 Left 2 !;.step param fsw list 40e3 100e3 200e3\n.param fsw=100e3 ; -> optimized for efficiency!\n.param Tsw {1/fsw}
TEXT 984 1496 Left 2 !; Third Experiment - Varying those with the highest impact on efficiency\n;.param Co 4.7u ; Fixed because its impact is very low\n \n;.step param Li list 10u 22u 33u\n;.step param Cc list 1u 2.2u 4.7u\n;.step param Lo list 10u 22u 33u 47u\n \n;.param Li 22u; ->  Optimized for efficiency! \n;.param Cc 1u; -> Optimized for efficiency!\n;.param Lo 47u ; -> Optimized for efficiency!\n \n; Result @ 40khz: (22uH, 1uF, 47uH) is 8.42% better than (33uH, 2.2uF, 10uH)\n; Result @ 100khz: (10uH, 1uF, 10uH) is 4.34% better than (33uH, 1uF, 33uH)\n \n;.step param L list 33u 22u 10u\n.param L 33u\n \n.param Li {L};\n.param Lo {L};\n.param Ci 100u;\n.param Cc 10u;\n.param Co 100u;\n  \n.param Li_esr 10m;\n.param Lo_esr 10m;\n.param Ci_esr 10m;\n.param Cc_esr 2m;\n.param Co_esr 10m;
TEXT 2320 472 Left 2 !;.inc FDMS86255.lib\n;.inc OptiMOS3_150V_LTSpice.lib\n.inc OptiMOS5_150V_LTSpice.lib\n;.inc PTNG_150V_std_rev3p6_ltspice.txt
TEXT 2328 624 Left 2 ;BSB165N15NZ3\nBSB280N15NZ3\nBSC074N15NS5\nBSC074N15NS5\nBSC093N15NS5\nBSC093N15NS5\nBSC110N15NS5\nBSC110N15NS5\nBSC160N15NS5\nBSC160N15NS5\nBSC190N15NS3\nBSC360N15NS3\nBSC520N15NS3\nBSZ300N15NS5\nBSZ300N15NS5\nBSZ520N15NS3\nBSZ900N15NS3\nFDMS8D8N15C_3p\nFDMS8D8N15C_5p\nIPA075N15N3\nIPA105N15N3\nIPB044N15N5\nIPB044N15N5\nIPB048N15N5\nIPB048N15N5\nIPB048N15N5LF\nIPB060N15N5\nIPB060N15N5\nIPB065N15N3\nIPB072N15N3\nIPB073N15N5\nIPB073N15N5\nIPB083N15N5LF\nIPB108N15N3\nIPB200N15N3\nIPB530N15N3\nIPD200N15N3\nIPD530N15N3\nIPI051N15N5\nIPI051N15N5\nIPI075N15N3\nIPI076N15N5\nIPI076N15N5\nIPI111N15N3\nIPI200N15N3\nIPI530N15N3\nIPP051N15N5\nIPP051N15N5\nIPP075N15N3\nIPP076N15N5\nIPP076N15N5\nIPP111N15N3\nIPP200N15N3\nIPP530N15N3\nIPT039N15N5\nIPT039N15N5\nIPT044N15N5\nIPT044N15N5\nIPT054N15N5\nIPT054N15N5\nIPT059N15N3\nIPT063N15N5\nIPT063N15N5\nNTB011N15MC_3P\nNTB011N15MC_5P\nNTB5D0N15MC_3P\nNTB5D0N15MC_5P\nNTB7D3N15MC_3P\nNTB7D3N15MC_5P\nNTBGS4D1N15MC_3P\nNTBGS4D1N15MC_5P\nNTBGS6D5N15MC_3P\nNTBGS6D5N15MC_5P\nNTDS015N15MC_3P\nNTDS015N15MC_5P\nNTMFS011N15MC_3P\nNTMFS011N15MC_5P\nNTMFS015N15MC_3P\nNTMFS015N15MC_5P\nNTMFS022N15MC_3P\nNTMFS022N15MC_5P\nNTMFS034N15MC_3P\nNTMFS034N15MC_5P\nNTMFS7D5N15MC_3P\nNTMFS7D5N15MC_5P\nNTMFSC012N15MC_3P\nNTMFSC012N15MC_5P\nNTMTS4D3N15MC_3P\nNTMTS4D3N15MC_5P\nNTP011N15MC_3P\nNTP011N15MC_5P\nNTP5D0N15MC_3P\nNTP5D0N15MC_5P\nNTP7D3N15MC_3P\nNTP7D3N15MC_5P\nNTTFS022N15MC_3P\nNTTFS022N15MC_5P\nNTTFS034N15MC_3P\nNTTFS034N15MC_5P\nNVBGS4D1N15MC_3P\nNVBGS4D1N15MC_5P\nNVBGS6D5N15MC_3P\nNVBGS6D5N15MC_5P\nNVBLS4D0N15MC_3P\nNVBLS4D0N15MC_5P\nNVDS015N15MC_3P\nNVDS015N15MC_5P
TEXT -1096 1520 Left 2 !.temp 50
TEXT -1504 776 Left 2 !.param Voc 24.9\n.param Isc 9.65\n.param Vmp 20.3\n.param Imp 8.75\n.param tk_voc -0.0031\n.param tk_isc 0.0005
TEXT -1240 1640 Left 2 ;Simplistic linear model, without thermal feedback.
TEXT -1224 2312 Left 2 ;Using Infinion's Optimos model, with thermal feedback.
TEXT -1176 1424 Left 3 ;Thermal Design Verification
TEXT 48 1432 Left 3 ;Power Losses Verification
TEXT -904 392 Left 2 !.param Rs {1}\n.param Cs {1n}\n.param Cs_esr {3m}
TEXT -2488 -688 Left 2 ;floating power supply (bootstrap)
TEXT -2272 -280 Right 1 ;bleeder
TEXT -2168 -128 Left 2 ;simplified model of a comercial isolated driver
RECTANGLE Normal -320 1040 -784 704 2
RECTANGLE Normal -448 2848 -1536 1472 2
RECTANGLE Normal -1536 1344 -800 704 2
RECTANGLE Normal -320 688 -976 320 2
RECTANGLE Normal 768 2848 -400 1472 2
RECTANGLE Normal -1696 416 -2480 -112 2
