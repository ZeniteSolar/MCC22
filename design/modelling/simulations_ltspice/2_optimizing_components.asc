Version 4
SHEET 1 2768 3988
WIRE -1344 368 -1360 368
WIRE -1184 368 -1200 368
WIRE -624 400 -624 384
WIRE -496 400 -496 384
WIRE -1440 416 -1488 416
WIRE -1360 416 -1360 368
WIRE -1360 416 -1440 416
WIRE -1184 416 -1184 368
WIRE -1152 416 -1184 416
WIRE -1120 416 -1152 416
WIRE -1152 448 -1152 416
WIRE -1488 464 -1488 416
WIRE -1360 464 -1360 416
WIRE -1344 464 -1360 464
WIRE -1184 464 -1184 416
WIRE -1184 464 -1200 464
WIRE -624 480 -640 480
WIRE -496 480 -512 480
WIRE 288 480 64 480
WIRE 592 480 352 480
WIRE -624 496 -624 480
WIRE -496 496 -496 480
WIRE -1488 560 -1488 496
WIRE -1152 560 -1152 528
WIRE -1152 560 -1488 560
WIRE -1120 560 -1152 560
WIRE -624 576 -624 560
WIRE -496 576 -496 560
WIRE 464 576 448 576
WIRE 464 592 464 576
WIRE 64 640 64 480
WIRE 96 640 64 640
WIRE 160 640 128 640
WIRE 176 640 160 640
WIRE 304 640 272 640
WIRE 320 640 304 640
WIRE 352 640 320 640
WIRE 416 640 384 640
WIRE 448 640 448 576
WIRE 448 640 416 640
WIRE 464 640 448 640
WIRE 576 640 544 640
WIRE 592 640 592 480
WIRE 592 640 576 640
WIRE 64 672 64 640
WIRE 592 672 592 640
WIRE 192 752 192 672
WIRE 256 752 256 672
WIRE 464 752 464 672
WIRE 528 752 528 672
WIRE -976 768 -1008 768
WIRE -880 768 -896 768
WIRE -656 768 -688 768
WIRE -560 768 -576 768
WIRE -144 784 -192 784
WIRE -80 784 -144 784
WIRE 64 784 64 752
WIRE 64 784 -80 784
WIRE 592 784 592 752
WIRE 752 784 592 784
WIRE 832 784 752 784
WIRE 880 784 832 784
WIRE -1008 816 -1008 768
WIRE -992 816 -1008 816
WIRE -560 816 -560 768
WIRE -80 816 -80 784
WIRE 752 816 752 784
WIRE -1008 832 -1008 816
WIRE -1008 832 -1040 832
WIRE -1168 848 -1216 848
WIRE 832 848 832 784
WIRE -1008 864 -1040 864
WIRE -144 864 -144 784
WIRE -1008 880 -1008 864
WIRE -992 880 -1008 880
WIRE -80 880 -80 848
WIRE -64 880 -80 880
WIRE 752 880 752 848
WIRE 752 880 736 880
WIRE -64 912 -80 912
WIRE 752 912 736 912
WIRE -1008 928 -1008 880
WIRE -880 928 -1008 928
WIRE -560 928 -560 896
WIRE -560 928 -688 928
WIRE -144 1024 -144 928
WIRE -144 1024 -192 1024
WIRE -80 1024 -80 912
WIRE -80 1024 -144 1024
WIRE -32 1024 -80 1024
WIRE 320 1024 320 640
WIRE 320 1024 48 1024
WIRE 624 1024 320 1024
WIRE 752 1024 752 912
WIRE 752 1024 704 1024
WIRE 832 1024 832 912
WIRE 832 1024 752 1024
WIRE 864 1024 832 1024
WIRE 880 1024 864 1024
WIRE 864 1056 864 1024
WIRE -224 1536 -320 1536
WIRE -64 1536 -144 1536
WIRE 144 1536 48 1536
WIRE 304 1536 224 1536
WIRE 512 1536 416 1536
WIRE 672 1536 592 1536
WIRE -320 1584 -320 1536
WIRE 48 1584 48 1536
WIRE 416 1584 416 1536
WIRE -64 1600 -64 1536
WIRE 304 1600 304 1536
WIRE 672 1600 672 1536
WIRE -320 1696 -320 1664
WIRE -64 1696 -64 1664
WIRE -64 1696 -320 1696
WIRE 48 1696 48 1664
WIRE 304 1696 304 1664
WIRE 304 1696 48 1696
WIRE 416 1696 416 1664
WIRE 672 1696 672 1664
WIRE 672 1696 416 1696
WIRE -1312 1712 -1360 1712
WIRE -1136 1712 -1184 1712
WIRE -320 1728 -320 1696
WIRE 48 1728 48 1696
WIRE 416 1728 416 1696
WIRE -1360 1760 -1408 1760
WIRE -1408 1792 -1440 1792
WIRE -1360 1792 -1360 1760
WIRE -224 1792 -320 1792
WIRE -64 1792 -144 1792
WIRE 144 1792 48 1792
WIRE 304 1792 224 1792
WIRE 512 1792 416 1792
WIRE 672 1792 592 1792
WIRE -1440 1840 -1440 1792
WIRE -1440 1840 -1488 1840
WIRE -1424 1840 -1440 1840
WIRE -1312 1840 -1312 1712
WIRE -1312 1840 -1344 1840
WIRE -1264 1840 -1312 1840
WIRE -1136 1840 -1136 1712
WIRE -1136 1840 -1184 1840
WIRE -1104 1840 -1136 1840
WIRE -992 1840 -1024 1840
WIRE -320 1840 -320 1792
WIRE 48 1840 48 1792
WIRE 416 1840 416 1792
WIRE -64 1856 -64 1792
WIRE 304 1856 304 1792
WIRE 672 1856 672 1792
WIRE -896 1872 -944 1872
WIRE -1312 1920 -1360 1920
WIRE -1136 1920 -1184 1920
WIRE -784 1920 -816 1920
WIRE -320 1952 -320 1920
WIRE -64 1952 -64 1920
WIRE -64 1952 -320 1952
WIRE 48 1952 48 1920
WIRE 304 1952 304 1920
WIRE 304 1952 48 1952
WIRE 416 1952 416 1920
WIRE 672 1952 672 1920
WIRE 672 1952 416 1952
WIRE -1360 1968 -1408 1968
WIRE -320 1984 -320 1952
WIRE 48 1984 48 1952
WIRE 416 1984 416 1952
WIRE -1408 2000 -1440 2000
WIRE -1360 2000 -1360 1968
WIRE -1440 2048 -1440 2000
WIRE -1440 2048 -1488 2048
WIRE -1424 2048 -1440 2048
WIRE -1312 2048 -1312 1920
WIRE -1312 2048 -1344 2048
WIRE -1264 2048 -1312 2048
WIRE -1136 2048 -1136 1920
WIRE -1136 2048 -1184 2048
WIRE -1104 2048 -1136 2048
WIRE -992 2048 -992 1840
WIRE -992 2048 -1024 2048
WIRE -944 2048 -944 1872
WIRE -944 2048 -992 2048
WIRE -896 2048 -944 2048
WIRE -784 2048 -784 1920
WIRE -784 2048 -816 2048
WIRE -752 2048 -784 2048
WIRE -624 2048 -672 2048
WIRE -544 2048 -624 2048
WIRE 144 2048 48 2048
WIRE 304 2048 224 2048
WIRE 512 2048 416 2048
WIRE 672 2048 592 2048
WIRE -224 2064 -320 2064
WIRE -64 2064 -144 2064
WIRE 48 2096 48 2048
WIRE 416 2096 416 2048
WIRE -320 2112 -320 2064
WIRE 304 2112 304 2048
WIRE 672 2112 672 2048
WIRE -64 2128 -64 2064
WIRE -944 2176 -944 2048
WIRE -816 2176 -944 2176
WIRE -624 2176 -624 2048
WIRE -624 2176 -752 2176
WIRE 48 2208 48 2176
WIRE 304 2208 304 2176
WIRE 304 2208 48 2208
WIRE 416 2208 416 2176
WIRE 672 2208 672 2176
WIRE 672 2208 416 2208
WIRE -320 2224 -320 2192
WIRE -64 2224 -64 2192
WIRE -64 2224 -320 2224
WIRE 48 2240 48 2208
WIRE 416 2240 416 2208
WIRE -320 2256 -320 2224
WIRE 144 2304 48 2304
WIRE 304 2304 224 2304
WIRE -224 2320 -320 2320
WIRE -64 2320 -144 2320
WIRE 48 2352 48 2304
WIRE -320 2368 -320 2320
WIRE 304 2368 304 2304
WIRE -64 2384 -64 2320
WIRE -1104 2400 -1184 2400
WIRE -992 2400 -1024 2400
WIRE -896 2432 -944 2432
WIRE 48 2464 48 2432
WIRE 304 2464 304 2432
WIRE 304 2464 48 2464
WIRE -784 2480 -816 2480
WIRE -320 2480 -320 2448
WIRE -64 2480 -64 2448
WIRE -64 2480 -320 2480
WIRE 48 2496 48 2464
WIRE -320 2512 -320 2480
WIRE -224 2560 -320 2560
WIRE -64 2560 -144 2560
WIRE 144 2560 48 2560
WIRE 304 2560 224 2560
WIRE 512 2560 416 2560
WIRE 672 2560 592 2560
WIRE -1104 2608 -1184 2608
WIRE -992 2608 -992 2400
WIRE -992 2608 -1024 2608
WIRE -944 2608 -944 2432
WIRE -944 2608 -992 2608
WIRE -896 2608 -944 2608
WIRE -784 2608 -784 2480
WIRE -784 2608 -816 2608
WIRE -752 2608 -784 2608
WIRE -544 2608 -624 2608
WIRE -320 2608 -320 2560
WIRE 48 2608 48 2560
WIRE 416 2608 416 2560
WIRE -64 2624 -64 2560
WIRE 304 2624 304 2560
WIRE 672 2624 672 2560
WIRE -320 2720 -320 2688
WIRE -64 2720 -64 2688
WIRE -64 2720 -320 2720
WIRE 48 2720 48 2688
WIRE 304 2720 304 2688
WIRE 304 2720 48 2720
WIRE 416 2720 416 2688
WIRE 672 2720 672 2688
WIRE 672 2720 416 2720
WIRE -944 2736 -944 2608
WIRE -816 2736 -944 2736
WIRE -624 2736 -624 2608
WIRE -624 2736 -752 2736
WIRE -320 2752 -320 2720
WIRE 48 2752 48 2720
WIRE 416 2752 416 2720
FLAG -1120 416 G
FLAG -1120 560 S
FLAG -624 576 D
FLAG -624 384 S
FLAG -496 576 A
FLAG -496 384 K
FLAG -192 1024 IN+
IOPIN -192 1024 In
FLAG -192 784 IN-
IOPIN -192 784 In
FLAG 160 640 S
FLAG 304 640 D
FLAG 880 1024 OUT-
IOPIN 880 1024 In
FLAG 880 784 OUT+
IOPIN 880 784 In
FLAG 416 640 A
FLAG 576 640 K
FLAG 864 1056 0
FLAG 192 592 G
FLAG -880 768 IN+
IOPIN -880 768 In
FLAG -880 928 IN-
IOPIN -880 928 In
FLAG -688 928 OUT-
IOPIN -688 928 In
FLAG -688 768 OUT+
IOPIN -688 768 In
FLAG -1216 880 0
FLAG 48 2240 0
FLAG 48 2496 0
FLAG 304 2304 Pout
FLAG 304 2048 Pin
FLAG 48 2752 0
FLAG 304 2560 Eff
FLAG -320 1728 0
FLAG -64 1536 Pmos
FLAG -320 1984 0
FLAG -64 1792 Pdiode
FLAG 48 1728 0
FLAG 304 1536 PLi
FLAG 48 1984 0
FLAG 304 1792 PLo
FLAG -320 2256 0
FLAG -64 2064 PCi
FLAG -320 2512 0
FLAG -64 2320 PCc
FLAG -320 2752 0
FLAG -64 2560 PCo
FLAG -1440 416 driver_out
FLAG -896 1872 HeatSink
FLAG -544 2048 0
FLAG -1488 1840 0
FLAG -1184 1712 M1Case
FLAG -1360 1712 M1Junction
FLAG -1408 1760 Pmos
FLAG -1488 2048 0
FLAG -1184 1920 M1Case
FLAG -1360 1920 M2Junction
FLAG -1408 1968 Pdiode
FLAG -816 1920 Amb
FLAG 256 752 M1Tj
FLAG 528 752 M2Tj
FLAG -896 2432 HeatSink2
FLAG -1184 2400 M1Case_
FLAG -1184 2608 M1Case_
FLAG -816 2480 Amb
FLAG 192 752 M1Case_
FLAG 464 752 M1Case_
FLAG -544 2608 0
FLAG 416 2752 0
FLAG 672 2560 Ploss
FLAG 416 1728 0
FLAG 672 1536 PsbubMos
FLAG -640 480 snb_M1
FLAG -512 480 snb_M2
FLAG 416 1984 0
FLAG 672 1792 PsbubDiode
FLAG 416 2240 0
FLAG 672 2048 Pshunts
SYMBOL diode -1344 480 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL diode -1200 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -1184 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4.7
SYMBOL res -1248 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 4.7
SYMBOL res -1168 432 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -576 800 R0
SYMATTR InstName Rout
SYMATTR Value {Ro}
SYMBOL res -640 384 R0
SYMATTR InstName Rs_M1
SYMATTR Value {Rs}
SYMBOL cap -640 496 R0
SYMATTR InstName Cs_M1
SYMATTR Value {Cs}
SYMATTR SpiceLine Rser={Cs_esr}
SYMBOL ind2 80 656 M0
WINDOW 39 36 108 Left 2
WINDOW 40 36 136 Left 2
SYMATTR InstName Li
SYMATTR Value {Li}
SYMATTR SpiceLine Rser={Li_esr}
SYMATTR Type ind
SYMATTR SpiceLine2 IC={Ii}
SYMBOL cap -128 928 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
WINDOW 39 24 -17 Left 2
WINDOW 40 24 -43 Left 2
SYMATTR InstName Ci
SYMATTR Value {Ci}
SYMATTR SpiceLine Rser={Ci_esr}
SYMATTR SpiceLine2 IC={Vi}
SYMBOL ind2 576 656 R0
WINDOW 39 36 108 Left 2
WINDOW 40 36 136 Left 2
SYMATTR InstName Lo
SYMATTR Value {Lo}
SYMATTR SpiceLine Rser={Lo_esr}
SYMATTR Type ind
SYMATTR SpiceLine2 IC={0.95*Io}
SYMBOL cap 816 848 R0
WINDOW 39 28 81 Left 2
WINDOW 40 28 102 Left 2
SYMATTR InstName Co
SYMATTR Value {Co}
SYMATTR SpiceLine Rser={Co_esr}
SYMATTR SpiceLine2 IC={0.95*Vo}
SYMBOL cap 352 496 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
WINDOW 39 -28 32 VBottom 2
WINDOW 40 -56 32 VBottom 2
SYMATTR InstName Cc
SYMATTR Value {Cc}
SYMATTR SpiceLine Rser={Cc_esr}
SYMATTR SpiceLine2 IC={0.95*(Vi+Vo)}
SYMBOL res 720 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RshuntOut
SYMATTR Value 1500u
SYMBOL res -48 1040 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName RshuntIn
SYMATTR Value 1500u
SYMBOL MiniSyms4\\voltage- -1488 480 R0
WINDOW 3 -18 -90 VRight 0
WINDOW 123 0 0 Left 0
WINDOW 39 7 17 Left 0
SYMATTR Value PULSE(0 15 0 1n 1n {D*Tsw} {Tsw})
SYMATTR SpiceLine Rser=100m Cpar=100n
SYMATTR InstName Driver
SYMBOL MiniSyms4\\res- -80 832 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 10k
SYMATTR InstName R12
SYMBOL MiniSyms4\\res- -80 896 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R15
SYMBOL MiniSyms4\\res- 752 832 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 47k
SYMATTR InstName R27
SYMBOL MiniSyms4\\res- 752 896 R180
WINDOW 3 9 -8 Left 0
WINDOW 0 13 9 Center 0
SYMATTR Value 1k
SYMATTR InstName R28
SYMBOL PV_cplx -1104 848 M0
WINDOW 3 236 59 Invisible 1
SYMATTR Value PV_cplx voc={Voc} isc={Isc} vmp={Vmp} imp={Imp} tk_voc={-tk_voc} tk_isc={tk_isc}
SYMATTR InstName PV
SYMBOL MiniSyms4\\voltage- -1216 864 M0
WINDOW 123 0 0 Left 0
WINDOW 39 11 39 Left 0
SYMATTR InstName Irradiance1
SYMATTR Value {G}
SYMBOL diode -1008 880 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4007
SYMBOL voltage -992 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName In
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMBOL voltage -672 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName Out
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMBOL bv 48 2080 R0
SYMATTR InstName B1
SYMATTR Value V=I(In)*V(IN+,IN-)
SYMBOL res 240 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 160
SYMBOL cap 288 2112 R0
SYMATTR InstName C7
SYMATTR Value 1u
SYMBOL bv 48 2336 R0
SYMATTR InstName B2
SYMATTR Value V=I(Out)*V(OUT+)
SYMBOL res 240 2288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 160
SYMBOL cap 288 2368 R0
SYMATTR InstName C10
SYMATTR Value 1u
SYMBOL bv 48 2592 R0
SYMATTR InstName B3
SYMATTR Value V=V(Pout)/V(Pin)
SYMBOL res 240 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R38
SYMATTR Value 160
SYMBOL cap 288 2624 R0
SYMATTR InstName C11
SYMATTR Value 10n
SYMBOL bv -320 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=I(M1)*V(D,S)
SYMATTR InstName B4
SYMBOL res -128 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R39
SYMATTR Value 160
SYMBOL cap -80 1600 R0
SYMATTR InstName C16
SYMATTR Value 1u
SYMBOL bv -320 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=I(M2)*V(K,D)
SYMATTR InstName B5
SYMBOL res -128 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R40
SYMATTR Value 160
SYMBOL cap -80 1856 R0
SYMATTR InstName C17
SYMATTR Value 1u
SYMBOL bv 48 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(S,IN-)*I(Li)
SYMATTR InstName B6
SYMBOL res 240 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R41
SYMATTR Value 160
SYMBOL cap 288 1600 R0
SYMATTR InstName C18
SYMATTR Value 1u
SYMBOL bv 48 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,OUT+)*I(Lo)
SYMATTR InstName B7
SYMBOL res 240 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R42
SYMATTR Value 160
SYMBOL cap 288 1856 R0
SYMATTR InstName C19
SYMATTR Value 1u
SYMBOL bv -320 2096 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(IN-,IN+)*I(Ci)
SYMATTR InstName B8
SYMBOL res -128 2048 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R43
SYMATTR Value 160
SYMBOL cap -80 2128 R0
SYMATTR InstName C8
SYMATTR Value 1u
SYMBOL bv -320 2352 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,S)*I(Cc)
SYMATTR InstName B9
SYMBOL res -128 2304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R44
SYMATTR Value 160
SYMBOL cap -80 2384 R0
SYMATTR InstName C9
SYMATTR Value 1u
SYMBOL bv -320 2592 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(OUT+)*I(Co)
SYMATTR InstName B10
SYMBOL res -128 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R45
SYMATTR Value 160
SYMBOL cap -80 2624 R0
SYMATTR InstName C20
SYMATTR Value 1u
SYMBOL voltage -768 2048 R270
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName Amb
SYMATTR Value {temp}
SYMBOL cap -816 2192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cthsa
SYMATTR Value 300n
SYMBOL MiniSyms4\\voltage- 112 640 R90
WINDOW 3 7 17 Left 0
WINDOW 123 0 0 Left 0
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName M1
SYMBOL MiniSyms4\\voltage- 368 640 R90
WINDOW 3 7 17 Left 0
WINDOW 123 0 0 Left 0
SYMATTR Value 0
SYMATTR SpiceLine Rser=0 Cpar=0
SYMATTR InstName M2
SYMBOL res -1168 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthJC1
SYMATTR Value 0.8
SYMBOL res -1008 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS1
SYMATTR Value 2
SYMBOL g -1328 1840 R90
WINDOW 0 34 27 VLeft 2
WINDOW 3 35 103 VLeft 2
SYMATTR InstName G1
SYMATTR Value 1
SYMBOL res -1168 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthJC2
SYMATTR Value 0.8
SYMBOL res -1008 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS2
SYMATTR Value 2
SYMBOL g -1328 2048 R90
WINDOW 0 34 27 VLeft 2
WINDOW 3 35 103 VLeft 2
SYMATTR InstName G2
SYMATTR Value 1
SYMBOL res -800 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthSA
SYMATTR Value 10
SYMBOL optimos_5 272 592 R90
WINDOW 3 98 151 Left 2
SYMATTR Value IPT063N15N5
SYMATTR InstName U1
SYMBOL optimos_5 544 592 R90
WINDOW 3 98 151 Left 2
SYMATTR Value IPT063N15N5
SYMATTR InstName U2
SYMBOL cap -816 2752 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cthsa1
SYMATTR Value 300n
SYMBOL res -1008 2384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS3
SYMATTR Value 2
SYMBOL res -1008 2592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthCS4
SYMATTR Value 2
SYMBOL res -800 2592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RthSA1
SYMATTR Value 10
SYMBOL bv 416 2592 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(Pmos)+V(Pdiode)+V(PLi)+V(PLo)+V(PCi)+V(PCc)+V(PCo)+V(PsbubMos)+V(PsbubDiode)
SYMATTR InstName B11
SYMBOL res 608 2544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 160
SYMBOL cap 656 2624 R0
SYMATTR InstName C1
SYMATTR Value 1u
SYMBOL bv 416 1568 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(S,snb_M1)*I(Rs_M1)+V(snb_M1,D)*I(Cs_M1)
SYMATTR InstName B12
SYMBOL res 608 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 160
SYMBOL cap 656 1600 R0
SYMATTR InstName C2
SYMATTR Value 1u
SYMBOL res -512 384 R0
SYMATTR InstName Rs_M2
SYMATTR Value {Rs}
SYMBOL cap -512 496 R0
SYMATTR InstName Cs_M2
SYMATTR Value {Cs}
SYMATTR SpiceLine Rser={Cs_esr}
SYMBOL bv 416 1824 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=V(K,snb_M2)*I(Rs_M2)+V(snb_M2,A)*I(Cs_M2)
SYMATTR InstName B13
SYMBOL res 608 1776 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 160
SYMBOL cap 656 1856 R0
SYMATTR InstName C3
SYMATTR Value 1u
SYMBOL bv 416 2080 R0
WINDOW 3 24 96 Left 1
SYMATTR Value V=-V(D)*I(RshuntOut)+V(IN+,D)*I(RshuntIn)
SYMATTR InstName B14
SYMBOL res 608 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 160
SYMBOL cap 656 2112 R0
SYMATTR InstName C4
SYMATTR Value 1u
TEXT -728 1208 Left 2 !.param tstart {0}\n.param tend {15m}\n.tran 0 {tend} {tstart}
TEXT 160 368 Left 2 ;OUT- Standard Floating Half-Bridge
TEXT -1344 736 Right 2 !.include pvlib.cir
TEXT -1504 968 Left 2 !.param G=1000\n;.step param G list 200 400 600 800 1000 1200
TEXT -1504 1064 Left 2 !; Optimal Operating Point: MPPT\n.param Vi {Vmp}\n.param Ii {Imp}\n.param Pi {Vmp * Imp}\n.param Ri {Vi/Ii}\n.param Eff=1\n.param Po {Eff * (G/1000) * Pi}\n.param Vo {(Po * Ro)**(1/2)}\n.param Io {Vo / Ro}\n.param D={(Vo/(Vi+Vo))}
TEXT -768 976 Left 2 !;.param RO 100\n.step param RO list 0.5 1 4 20 30 100
TEXT -1512 592 Left 2 !.step param fsw list 40e3 100e3 200e3\n;.param fsw=100e3 ; -> optimized for efficiency!\n.param Tsw {1/fsw}
TEXT 1056 480 Left 2 !; Third Experiment - Varying those with the highest impact on efficiency\n;.param Co 4.7u ; Fixed because its impact is very low\n \n;.step param Li list 10u 22u 33u\n;.step param Cc list 1u 2.2u 4.7u\n;.step param Lo list 10u 22u 33u 47u\n \n;.param Li 22u; ->  Optimized for efficiency! \n;.param Cc 1u; -> Optimized for efficiency!\n;.param Lo 47u ; -> Optimized for efficiency!\n \n; Result @ 40khz: (22uH, 1uF, 47uH) is 8.42% better than (33uH, 2.2uF, 10uH)\n; Result @ 100khz: (10uH, 1uF, 10uH) is 4.34% better than (33uH, 1uF, 33uH)\n \n.step param L list 33u 22u 10u\n;.param L 33u\n \n.param Li {L};\n.param Lo {L};\n.param Ci 100u;\n.param Cc 10u;\n.param Co 100u;\n  \n.param Li_esr 10m;\n.param Lo_esr 10m;\n.param Ci_esr 10m;\n.param Cc_esr 2m;\n.param Co_esr 10m;
TEXT 1992 480 Left 2 !;.inc FDMS86255.lib\n;.inc OptiMOS3_150V_LTSpice.lib\n.inc OptiMOS5_150V_LTSpice.lib\n;.inc PTNG_150V_std_rev3p6_ltspice.txt
TEXT 2000 632 Left 2 ;BSB165N15NZ3\nBSB280N15NZ3\nBSC074N15NS5\nBSC074N15NS5\nBSC093N15NS5\nBSC093N15NS5\nBSC110N15NS5\nBSC110N15NS5\nBSC160N15NS5\nBSC160N15NS5\nBSC190N15NS3\nBSC360N15NS3\nBSC520N15NS3\nBSZ300N15NS5\nBSZ300N15NS5\nBSZ520N15NS3\nBSZ900N15NS3\nFDMS8D8N15C_3p\nFDMS8D8N15C_5p\nIPA075N15N3\nIPA105N15N3\nIPB044N15N5\nIPB044N15N5\nIPB048N15N5\nIPB048N15N5\nIPB048N15N5LF\nIPB060N15N5\nIPB060N15N5\nIPB065N15N3\nIPB072N15N3\nIPB073N15N5\nIPB073N15N5\nIPB083N15N5LF\nIPB108N15N3\nIPB200N15N3\nIPB530N15N3\nIPD200N15N3\nIPD530N15N3\nIPI051N15N5\nIPI051N15N5\nIPI075N15N3\nIPI076N15N5\nIPI076N15N5\nIPI111N15N3\nIPI200N15N3\nIPI530N15N3\nIPP051N15N5\nIPP051N15N5\nIPP075N15N3\nIPP076N15N5\nIPP076N15N5\nIPP111N15N3\nIPP200N15N3\nIPP530N15N3\nIPT039N15N5\nIPT039N15N5\nIPT044N15N5\nIPT044N15N5\nIPT054N15N5\nIPT054N15N5\nIPT059N15N3\nIPT063N15N5\nIPT063N15N5\nNTB011N15MC_3P\nNTB011N15MC_5P\nNTB5D0N15MC_3P\nNTB5D0N15MC_5P\nNTB7D3N15MC_3P\nNTB7D3N15MC_5P\nNTBGS4D1N15MC_3P\nNTBGS4D1N15MC_5P\nNTBGS6D5N15MC_3P\nNTBGS6D5N15MC_5P\nNTDS015N15MC_3P\nNTDS015N15MC_5P\nNTMFS011N15MC_3P\nNTMFS011N15MC_5P\nNTMFS015N15MC_3P\nNTMFS015N15MC_5P\nNTMFS022N15MC_3P\nNTMFS022N15MC_5P\nNTMFS034N15MC_3P\nNTMFS034N15MC_5P\nNTMFS7D5N15MC_3P\nNTMFS7D5N15MC_5P\nNTMFSC012N15MC_3P\nNTMFSC012N15MC_5P\nNTMTS4D3N15MC_3P\nNTMTS4D3N15MC_5P\nNTP011N15MC_3P\nNTP011N15MC_5P\nNTP5D0N15MC_3P\nNTP5D0N15MC_5P\nNTP7D3N15MC_3P\nNTP7D3N15MC_5P\nNTTFS022N15MC_3P\nNTTFS022N15MC_5P\nNTTFS034N15MC_3P\nNTTFS034N15MC_5P\nNVBGS4D1N15MC_3P\nNVBGS4D1N15MC_5P\nNVBGS6D5N15MC_3P\nNVBGS6D5N15MC_5P\nNVBLS4D0N15MC_3P\nNVBLS4D0N15MC_5P\nNVDS015N15MC_3P\nNVDS015N15MC_5P
TEXT -1096 1520 Left 2 !.temp 50
TEXT -1504 776 Left 2 !.param Voc 24.9\n.param Isc 9.65\n.param Vmp 20.3\n.param Imp 8.75\n.param tk_voc -0.0031\n.param tk_isc 0.0005
TEXT -1240 1640 Left 2 ;Simplistic linear model, without thermal feedback.
TEXT -1224 2312 Left 2 ;Using Infinion's Optimos model, with thermal feedback.
TEXT -1176 1424 Left 3 ;Thermal Design Verification
TEXT 48 1432 Left 3 ;Power Losses Verification
TEXT -904 392 Left 2 !.param Rs {1}\n.param Cs {1n}\n.param Cs_esr {3m}
RECTANGLE Normal -320 1040 -784 704 2
RECTANGLE Normal -448 2848 -1536 1472 2
RECTANGLE Normal -992 320 -1536 688 2
RECTANGLE Normal -1536 1344 -800 704 2
RECTANGLE Normal -320 688 -976 320 2
RECTANGLE Normal 768 2848 -400 1472 2
